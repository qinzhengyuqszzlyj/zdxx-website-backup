<!DOCTYPE html><html lang="zh">
<head>
  <meta name="keywords" content="闵行区教师专业发展数字化支持系统"/><meta name="description" content="闵行区教师专业发展数字化支持系统"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta http-equiv='Content-Type' content='text/html; charset=utf-8'><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><title>登录</title>
  <!--    <link rel="stylesheet" th:href="@{#{webjars.fontawesomemin.css}}"/>--><!--    <link type="text/css" rel="stylesheet" th:href="@{#{webjars.latomin.css}}"/>--><link rel="icon" href="https://jiaoshi.mhedu.sh.cn/cas/favicon.ico" type="image/x-icon"/><link href="https://jiaoshi.mhedu.sh.cn/cas/css/antd.min.css" rel="stylesheet"><!--  <script type="text/javascript" th:src="@{#{webjars.jquerymin.js}}"></script>--><script src="https://jiaoshi.mhedu.sh.cn/cas/webjars/vue/2.6.9/dist/vue.min.js"></script>
  <script src="https://jiaoshi.mhedu.sh.cn/cas/webjars/axios/0.17.1/dist/axios.min.js"></script>
  <script src="https://jiaoshi.mhedu.sh.cn/cas/js/antd.min.js"></script>
  <script src="https://jiaoshi.mhedu.sh.cn/cas/js/jquery.js"></script>
  <script src="https://jiaoshi.mhedu.sh.cn/cas/js/function.js"></script>
  <script src="https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js"></script>
  <link rel="stylesheet" href="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/css/login4.css"/><script src="https://jiaoshi.mhedu.sh.cn/cas/js/btoa.min.js"></script>

  
  <!--  <link rel="stylesheet" th:href="@{${#themes.code('cas.standard.static.path')+'/css/login.css'}}"--><!--        href="../../static/themes/login_shmh/css/login.css"/>--><!--  <link rel="stylesheet" th:href="@{${#themes.code('cas.standard.static.path')+'/css/login2.css'}}"--><!--        href="../../static/themes/login_shmh/css/login2.css"/>--><!--  <link rel="stylesheet" th:href="@{${#themes.code('cas.standard.static.path')+'/css/cas.css'}}"--><!--        href="../../static/themes/login_shmh/css/cas.css"/>--></head>

<body>
<div class="header">
  <div class="header_box">
    <img
      src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/logo.png" alt=""
    ><span>闵行区教师专业发展数字化支持系统</span>
  </div>
</div>
<div class="bg">
  <div id="app" class="main">
    <div class="context">
      <div class="ban_left">
        <div @click="openPage('../index.jhtml')">
          <img src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/yxw.png"/><p>研修网</p>
        </div>
        <div @click="openPage('http://ylb.ct-edu.com.cn')">
          <img src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/ylb.png"/><p>云录播</p>
        </div>
        <div @click="openPage('http://10.107.58.34:89/main/login.aspx')">
          <img src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/zlfx.png"/><p>质量分析</p>
        </div>
        <div @click="openPage('http://10.107.58.121/login.html')">
          <img src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/dagl.png"/><p>档案管理</p>
        </div>
        <div @click="openPage('http://10.107.58.218/vision/portal.jsp')">
          <img src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/dafx.png"/><p>档案分析</p>
        </div>
        <div @click="openPage('space.jsp?do=home')">
          <img src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/sns.png"/><p>个人空间</p>
        </div>
      </div>
      <div class="log-wrap">
        <div style="text-align: right;margin-right:15px;margin-top:8px;position: relative;z-index: 0;">
          <img
            v-if="tabIndex === '1'"
            class="login-wxin"
            style="cursor: pointer;text-align:right;display: inline-block;"
            src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/icon-jiao.png" alt=""
            @click="() => tabIndex = '2'"
          ><img
            v-if="tabIndex === '2'"
            class="back"
            style="cursor: pointer;text-align:right;display: inline-block;"
            src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/icon-pwd.png" alt=""
            @click="() => tabIndex = '1'"
          ></div>
        <div v-show="tabIndex === '1'" class="user-login" style="margin-top:-45px;">
          <div class="log-tit">欢迎使用，请登录</div>
          <form class="login-submit" method="post" action="https://jiaoshi.mhedu.sh.cn/cas/login">
            <p class="p-row">
              <img
                src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/user.png" alt=""
              ><input name="username" v-model:value="formState.username" class="input-row" type="text"
                     placeholder="请输入用户名"></p>
            <p class="p-row">
              <img
                src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/key.png" alt=""
              ><input v-model:value="formState.password" class="input-row" placeholder="请输入密码" type="password"></p>
            <div class="div-checkbox">
              <div><input type="checkbox"><span style="margin-left:4px">记住密码</span></div>
              <span>找回密码</span>
            </div>
            <input type="hidden" name="execution" value="34544997-66f7-438a-bd62-8b262c1b3108_ZXlKaGJHY2lPaUpJVXpVeE1pSjkuaHMrNnNUWnc4amx4TGtJOEd3dERabnhBZGk1bHBGcDlTWTVsdHBBdll1TE15R2E0QlNpRU96eXRJbHNYM1hqa21qR2xmaEwvbUlvaEZUK1ZrU0ZlUENFdTBTTjkvSWFmZ3AwK3lNa2FYb3pidiszeTZLazcvWGp5d2pubU1RZmdSUGZiRkVNU2dtNWRtS1RkV2RudHlqS0Fpamt5amhnOVhwc2d6WXNQWUpnZUxaVTQxNjkrMWNtdW9FN3hCeldJa2tIbXpPTjA4bHBKM2VXMU1HdnBHS1dRVzErVXIydFd0NDdlajc2NTB6aSs2UXVkdUFjYjcxNlJhS2JyakRwUzBDTDdqRExsR3JZM2MxZFgxMEVWN2NVeGZuU2wvNHhBYUFKVHV0ZEthM01IcGIzUFpzcGpLOUFDcmE0ZTBqSGowVk5XNzVkOEpZbnRKN0ZXWExxckZGSG1RWkpxSGZXejY1MVhBS3dKdHNWZ0xhTFdzNnBMbHBKaEhQa0Z5bW8yQzQ3YXNTRDdjWmV1ZGhibUY2RzR3eVg1YVhpRFhjNUhLZWZSc1VFcXgxWXJyZmdwS2k2US9JeFRNWFNuSFl4THpkaDA3R2NCcXl2ZTRLVk1nYjRLVzdxQ0FJVWRzYVNpVjRIN2xzN3NhNzlDaUt0S3JXdXdCOEd6RW5xWVRLOHVGNEd4MzQrV002OXJsVnIzblRNME8yTTh3K3M2WnN6b3JNNVNFUmVjQjFiTHFwNktVOFhYV0pzV0VtajMraUEvN1czOFBZYjRYSTJmZGdyZVQ3UFd0ZDZKNkFYRGRQU2VBSU5MRHpwYmwwczRBbHFaMWVkYUhvd09INGU0aXh2Z1Q2UGdkZGdkLy8rZU5nU0IwcVFPTkRlVWxKQzRGVGJYQUNmSkVsL1ZBQkI1NS9XQWszK2tlNEFSK3VIQjE1SGxBY0VqSTFUTzlQN3ZRQ3ZWUzQyTTQyQXVZY3pMMkhOcnZoRlpCSWxNNVBsNnAySWtqRmx2MUtnTCtTMVk2QitmUTVqVFhsR0MrUk1aNVlianFUeVNucUx0SFRibEl1RHU2ODBKT3hpbHNTeW12b01MeG9IRG1IYUEyc3BKeTZwQkVwTkZvK01IMHdhc1AvUElUV1NrNHQ2SitzNFdodHU3RXhPWjMxYWFxWEJLcDQrZFhBWEhMVXlUOE5hWWcyTE5MZWpjZTkvR3lqallhNFNaWlJHZG5rVWNJTEVwekgzOGxqUUIwTjNUeVIwajdvZGpSQjREa1lxOHNkb0FhSVpFaVpPa1VTQy9ScjN0WEpUYkNZT2QvUWVXdkNYaFNROTcxd2VJZ2tPbHlybkJtckFWSkROYTdLYXU1cG9aTzBOMkF5NmZIRThDSlBDNWltcHFFbytSWHI0RnRKL29IM2dZZi9zZHc0T2MycW03V0JNYzdKL3hyUm8wZU1GOGc4ZzRYL090VThjazdTOXZpcXg0YmF6NVZsNzh6U2FtNzFEZ0YvZEV3b3EzQ3IrQUkybHI0RlN4cWpzVHhvT1RYek9QSnJ3TGZyM0tLUXJYUlBpcXRycDMrREYrdHp6N1pNa2N1eEFyM3VpeG5kZEtWb2gyeVV0TU42eFVNRWhQVW9ST1BJM3dLaVpxbHlkNW9BQ1B4cGw1MDNmNG5QRHdrb3pYd1Zob1dUSjNHZXFMVnJtTHRVVVVIQ3BhSVhEZmRaWDRIU1JzYlNPZ3FDcHpFV1JRNEVIRE4yVHU1ajhmMnIyTURtU1dka3RNMW1kTE9PdVpTb3oxV1NydDBQSml0Zm8xd3BpaWVSSjdvRHQxbDNUNnJ5MDBHWXZ0VWR0MnFEcHYyTE9Kc1p4dkhQRzM2eDFZUTdxK081aW1MUW9sUW56UFhQbUY4a2xITE5NZC9tT1orejVUeUdNWHQ0cWZaODhmTS9WMUs1disxTkdoVlNabEdmamtHOFBLczR0N0JqZjY2dmZlbERrS09ianZFY1lwT2picmNGZ1Rmc0ZVQ2piUFFvWnZWWEpHT0ltY0RiOU1IdWVodGU3MzZQZjBWSkxWc3hZcEJaSHZFNXRlZEM2KzNCUXUxTXRmZkVLdDhFWFhJZ2N4ajhPeVpzRk5sck9CUDBKUHZYNzZyd01xSWVtV201d3FVWVhEUnJlcDR0QmFzWW5xVXpxUzFuY2hxZnpTNWZVY2xleVV5M3RGT3NWcnVNa0NtNVNtYjhZZ09FaG9aRUE1dWd3eFVLd3RkZUoxdk93UXZLNVJ1WlFOdFAvckg5TGR4Ry9XVzgxL2ptc1ZQK1puc3BJVkczTTNHMUptdmp1S2NRYiswcVZRMU9NaUVVb1RPQ1BqTGRLUjRWQVRzS2FCL0Z6OFhNYUdaaFdNWnFOZC9CMzhxamRYMEQ0ajdJWm5VT1hRZEZYN3pOaTQ2bU9WNHZWd0Z1UDZoOWl4amtuUWJZSjZFZjBRdXI1dTVrMzFqRnpXMlRJcHpwbER1MjZUU3dwRVc3S1gvdVRQTlFmUFFjNmlqK1ZhbnZoNlE0VEFCc1FVS2lxNTJVOWNscDIrQ0R3VkY4WGw1Qmp1UVJhSWtoQzVvRTlITlpQcEZpckZvRkFmRmlySGJVMVVOa2VSdk54U0lmYU4rRm0weVppY3dUWllWQUtSSlZjUzdEbXNkSGl2cWhiKzFiRFRuSlVGOWF1THEyQS9INWlVV1MzblFnTEJOckd3aGZ2b1Y2TUNycW4vYmI3Q1pzRzNxaWZXRHpuMm54dnk0Sk1KSGlsYVFveDZQaGg5SVd1aXArd2FPbDF3NFpYVGZ0ckppMldqTTdRckNnTm14KzY4S1dHaTVSZXZwTzQwY2greVc4NDBRc1hBVXdOS3lzYW50OEZSOGpPazlTcmtGbG9tSmg1c2ttc2RkM0hXWk1jWUNzV05ja3I1NWx5M2x5dklSOWpuUFhqL2orWjg4c0JnWUtDbTd6NmhtZEpLb05vU25tdHdRTzA5QWFKU0lxYjBObXdCMTcyNDY1dDlVeDZwTzdGV0oyWXBCQkZJWGhndmxJUCtHQmY4SWU0dzJOMWFXQ0h0eEE2cmRWSmkvZVR0bkFlVDlGVFBVNGpvM1VSSEJLUXBXejZjeHNsYkw1U1NWWDhONmkvL09rTDN5SGxvTWpxMlRMNDdVZU1KRit6MTYzTS9qdGJTeThvNyt0SWIzZkx3cmZ0MEtuS3dsNlFnNnBVNURyZzd6c3VldHF3MXpROVpydUF6Q0tLU1dlYVFFUnArVExtbUZaWnB3alYrci9qL0Qyb1J1NWRFenJMeFlpYzFacTFlNDBoZWhxM0ZLWFZ5WVFlRG9Tc3lkdWxqOWlZbFlrNEJzMjY0NytmcG5mQ1R4N2VEbzBjeTZzak14UitVOWJDai9MeHpkeWp4NzdqMjJDMVZ3Z0NCUEVGWHRwcDh5R3Jod0NQSGNnSE9rNTFEWVFWeXNFMTBWa0JpWmRVNUlDdG4rdzhqUzR5dGh4YXZ2U0hJcmlmb09RVHdkN1NPMkFWL2tvTzg1UVpjSEZaNHNuY2QzZ0hBZDF2aEJaUkZDMHlQN05uQmR0cHpSL1k2QVp5RXliNEg0STB1SFY4M2RPUDQ1RGFTa3Q4UDlRMWpwUkVvNTJ3RzBpS0U0K0kzUGZ3ajRleXdRWXk3ZEVUTUtHb0hQMnBJamZFWFlFOVd3RHQ2NFBMNllBVW52ZHRpUmNDbG9TYjdvbjh5M2h3QkdoRnR4VE9JUTJPOUFJNmNwU0xGUHF1cWl1V2hPcjZ0VHFsVVM0WHozZUpxSWZJNmd6QU1zcXhUcGp4NG9VNFVjUXJKUnpPQXhjSFJYNmljaWdVZVFodE9RZ2s1Nk1FNUxiK3lVOW9Ua1BZM3h3bFBtcTVaM2h3RUN2S0xzSXFTVW9GcFYxK1RtcGhMZjZuYjh5anFlN0lDV0k2cWxvSUYrbUYvTm1FTWZoOG5FVGFaTzRTb2pjUXRYZzg4OXAwcVZsWU9mSkJYUTdIQzhXSlBZUTJhOGorVU5NeUpzS0hscGtlSlVkbU5IY1plNEtKalBDWWZVbUsva1dtRUUzbkhOdWl5SHR1cVAxOVFGc216Z0VZWHRzd2lsald5WDdGb2ZJV2tydThVd2c1SW96TlN4OUNxZGdnYUozSmJHNjc2U1BQcXhkNjFUTllnVFMxdEQvOFRnaDQ2V2ZOWHU1YzdwemJXREhtUnh1d2gwN3p3RFFVVDBuRUZPeVdsTUF4ZE16VW9TR2pzakVmdU5HZ0kzZzZQNG9sWGtzeTdFa0VTd1dGN3UxcmtnQlRzZFYycTNxMmxDUVB5dmx2d2VsWGhkb3NNNEo4dEpOZU04RFFXRnMxQmRHOHl6MnpmLnF3Y2Z3Y21ieEtkcEVLN1hDRl9JbzhEdWlzUi1OU3loQktpbWZIUU9CcnV5ZGRZTFVfRFRoYlh5M3V1UUwyU3Q3VFdRUkNxdmpnTzBtZzF5ck95VWdR"/><input type="hidden" name="_eventId" value="submit"/><input type="hidden" name="geolocation"/><input name="password" :value="password" type="hidden"><button class="login" type="submit" style="width: 100%">登录</button>
            </form>
        </div>
        <div class="log-wxin" v-show="tabIndex === '2'">
          <div id="login_container"></div>
        </div>
        <form style="display: none">
          <p class="log-btn">
            <button type="submit" id="login-mail" class="login-btn login-btn1" href="javascript:login();">登录
            </button>
          </p>
          <!--        </div>--></form>
      </div>

    </div>
    <div style="width:960px;color:#84878A;font-size: 12px;margin:0 auto">
      友情提醒：为了您更好地使用本系统，请使用IE9及以上、火狐、谷歌、搜狗浏览器
    </div>
    <div class="div-footer">
      <img src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/icp.png"/><span>沪ICP备05012047号</span>
      <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011202005321">
        <img src="https://jiaoshi.mhedu.sh.cn/cas/themes/login_shmh/images/login/guohui.png"/><span>沪公网安备 31011202005321号</span>
      </a>
    </div>
    <div style="display: none">
      <form method="post" style="display: none" id="tokenForm" action="https://jiaoshi.mhedu.sh.cn/cas/login">
        <input type="hidden" name="token" id="token"/><input type="hidden" name="execution" value="34544997-66f7-438a-bd62-8b262c1b3108_ZXlKaGJHY2lPaUpJVXpVeE1pSjkuaHMrNnNUWnc4amx4TGtJOEd3dERabnhBZGk1bHBGcDlTWTVsdHBBdll1TE15R2E0QlNpRU96eXRJbHNYM1hqa21qR2xmaEwvbUlvaEZUK1ZrU0ZlUENFdTBTTjkvSWFmZ3AwK3lNa2FYb3pidiszeTZLazcvWGp5d2pubU1RZmdSUGZiRkVNU2dtNWRtS1RkV2RudHlqS0Fpamt5amhnOVhwc2d6WXNQWUpnZUxaVTQxNjkrMWNtdW9FN3hCeldJa2tIbXpPTjA4bHBKM2VXMU1HdnBHS1dRVzErVXIydFd0NDdlajc2NTB6aSs2UXVkdUFjYjcxNlJhS2JyakRwUzBDTDdqRExsR3JZM2MxZFgxMEVWN2NVeGZuU2wvNHhBYUFKVHV0ZEthM01IcGIzUFpzcGpLOUFDcmE0ZTBqSGowVk5XNzVkOEpZbnRKN0ZXWExxckZGSG1RWkpxSGZXejY1MVhBS3dKdHNWZ0xhTFdzNnBMbHBKaEhQa0Z5bW8yQzQ3YXNTRDdjWmV1ZGhibUY2RzR3eVg1YVhpRFhjNUhLZWZSc1VFcXgxWXJyZmdwS2k2US9JeFRNWFNuSFl4THpkaDA3R2NCcXl2ZTRLVk1nYjRLVzdxQ0FJVWRzYVNpVjRIN2xzN3NhNzlDaUt0S3JXdXdCOEd6RW5xWVRLOHVGNEd4MzQrV002OXJsVnIzblRNME8yTTh3K3M2WnN6b3JNNVNFUmVjQjFiTHFwNktVOFhYV0pzV0VtajMraUEvN1czOFBZYjRYSTJmZGdyZVQ3UFd0ZDZKNkFYRGRQU2VBSU5MRHpwYmwwczRBbHFaMWVkYUhvd09INGU0aXh2Z1Q2UGdkZGdkLy8rZU5nU0IwcVFPTkRlVWxKQzRGVGJYQUNmSkVsL1ZBQkI1NS9XQWszK2tlNEFSK3VIQjE1SGxBY0VqSTFUTzlQN3ZRQ3ZWUzQyTTQyQXVZY3pMMkhOcnZoRlpCSWxNNVBsNnAySWtqRmx2MUtnTCtTMVk2QitmUTVqVFhsR0MrUk1aNVlianFUeVNucUx0SFRibEl1RHU2ODBKT3hpbHNTeW12b01MeG9IRG1IYUEyc3BKeTZwQkVwTkZvK01IMHdhc1AvUElUV1NrNHQ2SitzNFdodHU3RXhPWjMxYWFxWEJLcDQrZFhBWEhMVXlUOE5hWWcyTE5MZWpjZTkvR3lqallhNFNaWlJHZG5rVWNJTEVwekgzOGxqUUIwTjNUeVIwajdvZGpSQjREa1lxOHNkb0FhSVpFaVpPa1VTQy9ScjN0WEpUYkNZT2QvUWVXdkNYaFNROTcxd2VJZ2tPbHlybkJtckFWSkROYTdLYXU1cG9aTzBOMkF5NmZIRThDSlBDNWltcHFFbytSWHI0RnRKL29IM2dZZi9zZHc0T2MycW03V0JNYzdKL3hyUm8wZU1GOGc4ZzRYL090VThjazdTOXZpcXg0YmF6NVZsNzh6U2FtNzFEZ0YvZEV3b3EzQ3IrQUkybHI0RlN4cWpzVHhvT1RYek9QSnJ3TGZyM0tLUXJYUlBpcXRycDMrREYrdHp6N1pNa2N1eEFyM3VpeG5kZEtWb2gyeVV0TU42eFVNRWhQVW9ST1BJM3dLaVpxbHlkNW9BQ1B4cGw1MDNmNG5QRHdrb3pYd1Zob1dUSjNHZXFMVnJtTHRVVVVIQ3BhSVhEZmRaWDRIU1JzYlNPZ3FDcHpFV1JRNEVIRE4yVHU1ajhmMnIyTURtU1dka3RNMW1kTE9PdVpTb3oxV1NydDBQSml0Zm8xd3BpaWVSSjdvRHQxbDNUNnJ5MDBHWXZ0VWR0MnFEcHYyTE9Kc1p4dkhQRzM2eDFZUTdxK081aW1MUW9sUW56UFhQbUY4a2xITE5NZC9tT1orejVUeUdNWHQ0cWZaODhmTS9WMUs1disxTkdoVlNabEdmamtHOFBLczR0N0JqZjY2dmZlbERrS09ianZFY1lwT2picmNGZ1Rmc0ZVQ2piUFFvWnZWWEpHT0ltY0RiOU1IdWVodGU3MzZQZjBWSkxWc3hZcEJaSHZFNXRlZEM2KzNCUXUxTXRmZkVLdDhFWFhJZ2N4ajhPeVpzRk5sck9CUDBKUHZYNzZyd01xSWVtV201d3FVWVhEUnJlcDR0QmFzWW5xVXpxUzFuY2hxZnpTNWZVY2xleVV5M3RGT3NWcnVNa0NtNVNtYjhZZ09FaG9aRUE1dWd3eFVLd3RkZUoxdk93UXZLNVJ1WlFOdFAvckg5TGR4Ry9XVzgxL2ptc1ZQK1puc3BJVkczTTNHMUptdmp1S2NRYiswcVZRMU9NaUVVb1RPQ1BqTGRLUjRWQVRzS2FCL0Z6OFhNYUdaaFdNWnFOZC9CMzhxamRYMEQ0ajdJWm5VT1hRZEZYN3pOaTQ2bU9WNHZWd0Z1UDZoOWl4amtuUWJZSjZFZjBRdXI1dTVrMzFqRnpXMlRJcHpwbER1MjZUU3dwRVc3S1gvdVRQTlFmUFFjNmlqK1ZhbnZoNlE0VEFCc1FVS2lxNTJVOWNscDIrQ0R3VkY4WGw1Qmp1UVJhSWtoQzVvRTlITlpQcEZpckZvRkFmRmlySGJVMVVOa2VSdk54U0lmYU4rRm0weVppY3dUWllWQUtSSlZjUzdEbXNkSGl2cWhiKzFiRFRuSlVGOWF1THEyQS9INWlVV1MzblFnTEJOckd3aGZ2b1Y2TUNycW4vYmI3Q1pzRzNxaWZXRHpuMm54dnk0Sk1KSGlsYVFveDZQaGg5SVd1aXArd2FPbDF3NFpYVGZ0ckppMldqTTdRckNnTm14KzY4S1dHaTVSZXZwTzQwY2greVc4NDBRc1hBVXdOS3lzYW50OEZSOGpPazlTcmtGbG9tSmg1c2ttc2RkM0hXWk1jWUNzV05ja3I1NWx5M2x5dklSOWpuUFhqL2orWjg4c0JnWUtDbTd6NmhtZEpLb05vU25tdHdRTzA5QWFKU0lxYjBObXdCMTcyNDY1dDlVeDZwTzdGV0oyWXBCQkZJWGhndmxJUCtHQmY4SWU0dzJOMWFXQ0h0eEE2cmRWSmkvZVR0bkFlVDlGVFBVNGpvM1VSSEJLUXBXejZjeHNsYkw1U1NWWDhONmkvL09rTDN5SGxvTWpxMlRMNDdVZU1KRit6MTYzTS9qdGJTeThvNyt0SWIzZkx3cmZ0MEtuS3dsNlFnNnBVNURyZzd6c3VldHF3MXpROVpydUF6Q0tLU1dlYVFFUnArVExtbUZaWnB3alYrci9qL0Qyb1J1NWRFenJMeFlpYzFacTFlNDBoZWhxM0ZLWFZ5WVFlRG9Tc3lkdWxqOWlZbFlrNEJzMjY0NytmcG5mQ1R4N2VEbzBjeTZzak14UitVOWJDai9MeHpkeWp4NzdqMjJDMVZ3Z0NCUEVGWHRwcDh5R3Jod0NQSGNnSE9rNTFEWVFWeXNFMTBWa0JpWmRVNUlDdG4rdzhqUzR5dGh4YXZ2U0hJcmlmb09RVHdkN1NPMkFWL2tvTzg1UVpjSEZaNHNuY2QzZ0hBZDF2aEJaUkZDMHlQN05uQmR0cHpSL1k2QVp5RXliNEg0STB1SFY4M2RPUDQ1RGFTa3Q4UDlRMWpwUkVvNTJ3RzBpS0U0K0kzUGZ3ajRleXdRWXk3ZEVUTUtHb0hQMnBJamZFWFlFOVd3RHQ2NFBMNllBVW52ZHRpUmNDbG9TYjdvbjh5M2h3QkdoRnR4VE9JUTJPOUFJNmNwU0xGUHF1cWl1V2hPcjZ0VHFsVVM0WHozZUpxSWZJNmd6QU1zcXhUcGp4NG9VNFVjUXJKUnpPQXhjSFJYNmljaWdVZVFodE9RZ2s1Nk1FNUxiK3lVOW9Ua1BZM3h3bFBtcTVaM2h3RUN2S0xzSXFTVW9GcFYxK1RtcGhMZjZuYjh5anFlN0lDV0k2cWxvSUYrbUYvTm1FTWZoOG5FVGFaTzRTb2pjUXRYZzg4OXAwcVZsWU9mSkJYUTdIQzhXSlBZUTJhOGorVU5NeUpzS0hscGtlSlVkbU5IY1plNEtKalBDWWZVbUsva1dtRUUzbkhOdWl5SHR1cVAxOVFGc216Z0VZWHRzd2lsald5WDdGb2ZJV2tydThVd2c1SW96TlN4OUNxZGdnYUozSmJHNjc2U1BQcXhkNjFUTllnVFMxdEQvOFRnaDQ2V2ZOWHU1YzdwemJXREhtUnh1d2gwN3p3RFFVVDBuRUZPeVdsTUF4ZE16VW9TR2pzakVmdU5HZ0kzZzZQNG9sWGtzeTdFa0VTd1dGN3UxcmtnQlRzZFYycTNxMmxDUVB5dmx2d2VsWGhkb3NNNEo4dEpOZU04RFFXRnMxQmRHOHl6MnpmLnF3Y2Z3Y21ieEtkcEVLN1hDRl9JbzhEdWlzUi1OU3loQktpbWZIUU9CcnV5ZGRZTFVfRFRoYlh5M3V1UUwyU3Q3VFdRUkNxdmpnTzBtZzF5ck95VWdR"/><input type="hidden" name="_eventId" value="tokenSubmit"/><input type="hidden" name="geolocation"/><button type="submit" size="large" class="btn-red login-btn">登 录</button>
      </form>
      <a-modal
        title="请绑定mfa"
        :visible="visible"
        width="400px"
        ok-text="已绑定"
        cancel-text="取消"
        @cancel="handleCancel"
        @ok="handleOk"
      >
        <div>
          <img :src="mfaSrc"/></div>
      </a-modal>
      <a-modal
        title="请绑定账号"
        :visible="wechatBindVisible"
        width="400px"
        ok-text="确定"
        cancel-text="取消"
        @cancel="handleBindCancel"
        @ok="handleBind"
      >
        <div>
          <a-input
            name="username"
            size="large" v-model="modalData.username" placeholder="请输入用户名"
            autocomplete="off"
          >
            <template #prefix>
              <a-icon type="user"/></template>
          </a-input>
          <a-input-password
            name="password"
            size="large" v-model="modalData.password" placeholder="请输入密码"
            autocomplete="off"
            style="margin-top: 20px;"
          >
          </a-input-password>
        </div>
      </a-modal>
    </div>
  </div>
</div>
<script>
    //<![CDATA[
    let app = new Vue({
        el: '#app',
        data() {
            return {
                visible: false,
                wechatBindVisible: false,
                formState: {
                    username: '',
                    password: '',
                    code: ''
                },
                modalData: {
                    token: '',
                    username: '',
                    password: ''
                },
                mfaSrc: '',
                tabIndex: '1'
            }
        },
        computed: {
            password() {
                if (!this.formState.password) {
                    return ''
                }
                return $.base64.btoatimes(this.formState.password, 3)
            }
        },
        methods: {
            async checkUsername() {
                const {username} = this.formState
                const res = await axios.post("\/cas\/mfa\/check\/"
                    + username, {})
                console.log(res)
                if (res.data.code === '1002') {
                    this.visible = true
                    const mfaSrcData = await axios.post("\/cas\/mfa\/qrcode\/"
                        + username, {})

                    this.mfaSrc = mfaSrcData.data
                }
            },
            handleCancel() {
                this.visible = false
            },
            async handleOk() {
                const res = await axios.post("\/cas\/mfa\/bind\/"
                    + this.formState.username, {})
                const {code, msg} = res.data
                this.visible = false
            },
            async handleBind() {
                const res = await axios.post("\/cas\/wechat\/bind", this.modalData)
                const data = res.data
                if (data.success) {
                    if (this.service) {
                        window.location.href ="\/cas\/login"
                            + `?token=${this.modalData.token}&service=${encodeURIComponent(this.service)}`
                    } else {
                        window.location.href ="\/cas\/login"
                            + `?token=${this.modalData.token}`
                    }
                } else {
                    antd.message.error(data.message)
                }
            },
            handleBindCancel() {
                this.wechatBindVisible = false
            },
            doLogin() {

            },
            async handleSubmit() {
                const res = await axios.post("\/cas\/mfa\/login"
                    , this.formState)
                // alert(JSON.stringify(res.data))
                const {code, msg, token} = res.data
                if (code === '0') {
                    this.tokenSubmit(token)
                } else if (code === '1002') {
                    this.visible = true
                    const mfaSrcData = await axios.post("\/cas\/mfa\/qrcode\/"
                        + this.formState.username, {})
                    this.mfaSrc = mfaSrcData.data
                } else {
                    antd.message.error(msg)
                }
            },
            tokenSubmit(token) {
                if (token) {
                    $('#token').val(token)
                    $("#tokenForm").submit();
                }
            },
            wechatInit() {
                const service = getQueryString("service");
                const params = service ? {service: encodeURIComponent(service)} : {}
                axios.post("\/cas\/wechat\/wechat-params", params).then(res => {
                    const {appid, state, redirect_uri} = res.data
                    const obj = new WxLogin({
                        appid,
                        state,
                        redirect_uri,
                        self_redirect: false,
                        id: "login_container",
                        scope: "snsapi_login",
                        style: ""
                    });
                })
            },
            async wechatCallback() {
                const code = getQueryString("code");
                const state = getQueryString("state");
                const wechat_token = getQueryString("wechat_token");

                if (code && state) {
                    const {data} = await axios.post("\/cas\/wechat\/auth", {code, state})
                    const {auth, service, token} = data || {}
                    if (!token) {
                        window.location.href ="\/cas\/login"
                        return
                    }
                    if (auth) {
                        this.tokenSubmit(token)
                        // window.location.href =/*"\/cas\/login"*/"/cas/login" + `?token=${token}&service=${service}`
                        return
                    }
                    const params = {
                        type: 'wechat',
                        wechat_token: token,
                        service
                    }
                    window.location.href = "\/cas\/login"
                        + '?' + $.param(params)
                    return
                }
                if (wechat_token) {
                    const {data} = await axios.post("\/cas\/wechat\/check", {token: wechat_token})
                    const {auth} = data || {}
                    if (auth) {
                        this.tokenSubmit(wechat_token)
                    } else {
                        this.modalData.token = wechat_token
                        this.wechatBindVisible = true
                    }
                }
            },
            findPsw() {
                window.location.href = "/sns/do.jsp?ac=findpswd";
            },
            openPage(url) {
                window.open(url)
            },
        },
        mounted() {
            const token = getQueryString("token");
            if (token) {
                this.tokenSubmit(token)
                return
            }
            const type = getQueryString("type");
            if (type === 'wechat') {
                this.wechatCallback()
                return;
            }
            this.wechatInit()
        }
    })
    //]]>
</script>
</body>
</html>
